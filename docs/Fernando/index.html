<!doctype html>
<html lang="es" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Fernando" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Fernando - Windows Service | Presentacion | .Net Framework</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fernandojosemoran.github.io/exposition-net-framework/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://fernandojosemoran.github.io/exposition-net-framework/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://fernandojosemoran.github.io/exposition-net-framework/docs/Fernando"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Fernando - Windows Service | Presentacion | .Net Framework"><meta data-rh="true" name="description" content="¿Qué es un servicio de Windows?"><meta data-rh="true" property="og:description" content="¿Qué es un servicio de Windows?"><link data-rh="true" rel="icon" href="/exposition-net-framework/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://fernandojosemoran.github.io/exposition-net-framework/docs/Fernando"><link data-rh="true" rel="alternate" href="https://fernandojosemoran.github.io/exposition-net-framework/docs/Fernando" hreflang="es"><link data-rh="true" rel="alternate" href="https://fernandojosemoran.github.io/exposition-net-framework/docs/Fernando" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/exposition-net-framework/blog/rss.xml" title="Presentacion | .Net Framework RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/exposition-net-framework/blog/atom.xml" title="Presentacion | .Net Framework Atom Feed"><link rel="stylesheet" href="/exposition-net-framework/assets/css/styles.9a10cf95.css">
<link rel="preload" href="/exposition-net-framework/assets/js/runtime~main.6b82afc8.js" as="script">
<link rel="preload" href="/exposition-net-framework/assets/js/main.b1947578.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_Evqc" href="#__docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/exposition-net-framework/"><div class="navbar__logo"><img src="/exposition-net-framework/img/logo.svg" alt="My Site Logo" class="themedImage__xvq themedImage--light_fEe8"><img src="/exposition-net-framework/img/logo.svg" alt="My Site Logo" class="themedImage__xvq themedImage--dark_T3Pi"></div><b class="navbar__title text--truncate">Exposicion de .net Framework</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/exposition-net-framework/docs/Alex">Tutorial</a></div><div class="navbar__items navbar__items--right"><div class="toggle_bQum colorModeToggle_iefX"><button class="clean-btn toggleButton_B24r toggleButtonDisabled_GmQq" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Jtzh"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_AcFY"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_KJu8"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_vrtr docsWrapper_UyTm"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_dgaC" type="button"></button><div class="docPage_AP65"><aside class="theme-doc-sidebar-container docSidebarContainer_P1BV"><div class="sidebarViewport_spOZ"><div class="sidebar_viiM"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y4D1"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/exposition-net-framework/docs/Alex">Alex - Windows Form</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/exposition-net-framework/docs/Sergio">Sergio - WPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/exposition-net-framework/docs/Fernando">Fernando - Windows Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/exposition-net-framework/docs/Alex-front">Alex - ASP.NET (Front)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/exposition-net-framework/docs/Sergio-back">Sergio - ASP.NET (back)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/exposition-net-framework/docs/Fernando-aplicacion-de-cmd">Fernando - Aplicacion De Consola</a></li></ul></nav></div></div></aside><main class="docMainContainer_Zp_p"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_KoNO"><div class="docItemContainer_HQCS"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer__hc5" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/exposition-net-framework/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_EdK6"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Fernando - Windows Service</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_Q_YQ theme-doc-toc-mobile tocMobile_HVxj"><button type="button" class="clean-btn tocCollapsibleButton_eJ1q">En esta página</button></div><div class="theme-doc-markdown markdown"><header><h1>Fernando - Windows Service</h1></header><div class="language-c# codeBlockContainer_TkhV theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_FoC1">Este ejemplo hace uso de las siguientes librerias</div><div class="codeBlockContent_sQUh"><pre tabindex="0" class="prism-code language-c# codeBlock_QKyX thin-scrollbar"><code class="codeBlockLines_dfib"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.ComponentModel;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.ServiceProcess;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.Timers;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System.IO;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System;</span><br></span></code></pre><div class="buttonGroup_oSIr"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_Fh8o" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_s6BV"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Hhpu"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="qué-es-un-servicio-de-windows">¿Qué es un servicio de Windows?<a href="#qué-es-un-servicio-de-windows" class="hash-link" aria-label="Enlace directo al ¿Qué es un servicio de Windows?" title="Enlace directo al ¿Qué es un servicio de Windows?">​</a></h2><p>Los servicios de Windows son aplicaciones de software que no son UI y que se ejecutan en segundo plano. Los servicios de Windows generalmente se inician cuando se inicia un sistema operativo y está programado para ejecutarse en segundo plano para ejecutar algunas tareas. Los servicios de Windows también se pueden iniciar de forma automática o manual. También puede pausar, detener y reiniciar manualmente los servicios de Windows.</p><p>El servicio de Windows es un programa informático que se ejecuta en segundo plano para ejecutar algunas tareas. Algunos ejemplos de servicios de Windows son la actualización automática de Windows, consultar correos electrónicos, imprimir documentos, el Agente SQL Server, escaneo e indexación de archivos y carpetas, etc. Si abre el Administrador de tareas y hace clic en la pestaña Servicios, verá cientos de servicios. ejecutándose en su máquina. También puede ver los estados de estos servicios. Algunos servicios se están ejecutando, otros se han detenido y otros se han detenido. Puede iniciar, detener y pausar un servicio desde aquí haciendo clic derecho en el servicio.</p><p><img loading="lazy" src="/exposition-net-framework/img/servicios-de-windows.jpg" alt="servicios de windows" class="img_AMxF"></p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="empezamos">Empezamos<a href="#empezamos" class="hash-link" aria-label="Enlace directo al Empezamos" title="Enlace directo al Empezamos">​</a></h2><p>Buscamos <strong>Windows Service</strong> y escogemos la opcion que dice <em>.net framework</em>.</p><p><img loading="lazy" src="/exposition-net-framework/img/Buscando-tecnologia-de-windows-service.png" alt="Buscando tecnologia de windows service" class="img_AMxF"></p><p>Despues nombramos nuestro proyecto.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_kKve"><div class="admonitionHeading_wtUf"><span class="admonitionIcon_axhX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Nombra de forma correcta tus proyectos</div><div class="admonitionContent_NrEf"><p>No uses espacios en blanco, por ejemplo <strong>(No llames tu proyecto asi)</strong>. Ademas no uses caracteres raros como <strong>?%$^()][{}#&amp;</strong> entre otros solo usa letras del alfabeto, recomendablemente solo del alfabero americano.</p></div></div><p><img loading="lazy" src="/exposition-net-framework/img/nombrando-nuestro-proyecto-de-windows-service.png" alt="nombrando nuestro proyecto de windows service" class="img_AMxF"></p><h3 class="anchor anchorWithStickyNavbar_c6Kk" id="panorama-principal-al-iniciar-el-proyecto">Panorama principal al iniciar el proyecto.<a href="#panorama-principal-al-iniciar-el-proyecto" class="hash-link" aria-label="Enlace directo al Panorama principal al iniciar el proyecto." title="Enlace directo al Panorama principal al iniciar el proyecto.">​</a></h3><p><img loading="lazy" src="/exposition-net-framework/img/panorama-de-inicio-del-proyecto.png" alt="panorama de inicio del proyecto" class="img_AMxF"></p><p>Nos indica que debemos arrastrar un elemento de la caja de herramientas asi la interfaz grafica o canvas.</p><p><em><a href="/exposition-net-framework/docs/Alex">Como activar la toolbox o caja de herramientas</a></em>, Recuerda ir a la seccion de <strong>Activamos las ventana de caja de herramientas</strong>.</p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="agregar-un-instalador-para-windows-server">Agregar un instalador para windows server<a href="#agregar-un-instalador-para-windows-server" class="hash-link" aria-label="Enlace directo al Agregar un instalador para windows server" title="Enlace directo al Agregar un instalador para windows server">​</a></h2><p>Para agregar un instalador, debemos dar click izquierdo y se desplegara una ventana con opciones.
A nosotros nos interesa la que dice <strong>Add Installer o Agregar Instalador</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/agregar-un-instalador.png" alt="agregar un instalador" class="img_AMxF"></p><p>Despues tendremos un panorama de una pestalla abierta.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/vista-previa-despues-de-hacer-click-en-agregar-instalador.png" alt="vista previa despues de hacer click en agregar instalador" class="img_AMxF"></p><p>Esta pestaña hace referencia al archivo que se creo al agregar el installer. Tu puedes verlo mirando los archivos del proyecto.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mostrando-instalador-creado.png" alt="mostrando instalador creado" class="img_AMxF"></p><p>Bien, ahora observemos el codigo fuente del installer o instalador.
Para eso damos click izquierdo y click a la opcion que dice <strong>View Code o Ver Codigo</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/seleccionando-la-opcion-de-ver-codigo.png" alt="seleccionando la opcion de ver codigo" class="img_AMxF"></p><p>El codigo del installer o instalador se miraria de la siguiente forma.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mirando-el-codigo-fuente-del-instalador.png" alt="mirando el codigo fuente del instalador" class="img_AMxF"></p><p>Vamos a explicar lo que señala las flechas</p><div class="codeBlockContainer_TkhV theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_sQUh"><pre tabindex="0" class="prism-code language-text codeBlock_QKyX thin-scrollbar"><code class="codeBlockLines_dfib"><span class="token-line" style="color:#F8F8F2"><span class="token plain">La flecha roja indica a que grupo de logica de codigo pertenece, por ejemplo el installer o instalador pertenece a la misma logica de programacion a la que pertenece nuestra interfaz grafica o interfaz de aplicacion. </span><br></span></code></pre><div class="buttonGroup_oSIr"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_Fh8o" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_s6BV"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Hhpu"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>La fecha verde </p><div class="codeBlockContainer_TkhV theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_sQUh"><pre tabindex="0" class="prism-code language-text codeBlock_QKyX thin-scrollbar"><code class="codeBlockLines_dfib"><span class="token-line" style="color:#F8F8F2"><span class="token plain">La flecha verder indica el nombre del la clase que hace posible que el installer o instalador exista, ademas hace uso de un metodo que inicializa el instalador.</span><br></span></code></pre><div class="buttonGroup_oSIr"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_Fh8o" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_s6BV"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Hhpu"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Bueno verifiquemos si en realidad pertenece a la mismo campo de logica que el installer o instalador.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mostrando-codigo-del-windows-servicio.png" alt="mostrando codigo del windows servicio" class="img_AMxF"></p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="modificando-propiedades-del-servicio">Modificando propiedades del servicio<a href="#modificando-propiedades-del-servicio" class="hash-link" aria-label="Enlace directo al Modificando propiedades del servicio" title="Enlace directo al Modificando propiedades del servicio">​</a></h2><p>Ahora Observemos las propiedades mediante el codigo del componente que instancia el metodo de disponse.
Para eso debes de poner el puntero del mouse en el componente marcado en rojo y pretar <strong>la tecla control + click</strong></p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mostrando-componente-o-funcion-a-ver-codigo.png" alt="mostrando componente o funcion a ver codigo" class="img_AMxF"></p><p>Si has echo todo bien, podras ver el codigo que compone internamente el componente <strong>InitializeComponent();</strong>.</p><p>Podras notar con las flecha de color rojo el nombre del servicio.
Y con el lo que esta marcado de verde algunas propiedades que conforman el servicio.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/observando-codigo-del-componente-que-inicializaba-el-metodo-del-installer-o-instalador.png" alt="observando codigo del componente que inicializaba el metodo del installer o instalador" class="img_AMxF"></p><p>Perfecto, agregamos una propiedad de cuenta al componente y le asignamos un valor indicandole que es un servicio local.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/agregamos-una-propiedad-y-le-asignamos-un-valor.png" alt="agregamos una propiedad y le asignamos un valor" class="img_AMxF"></p><p>Bien, vamos a agregar dos propiedades mas que son fundamentales para los servicios de windows, ya que son indentificadores visuales.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/agregando-otras-propiedades-excensiales.png" alt="agregando otras propiedades excensiales" class="img_AMxF"></p><p>A que te hace sentido la propiedad <strong>Description y DisplayName</strong>. Bueno si eres informatico, alguna vez escuchastes o has abierto los servicios de windows, aunque no sepas con exactitud sus funcionalidades. las propiedades anteriores hacen referencia a los campos principales de la ventana de servicios de windows.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mostrando-la-funcionalidad-de-las-propiedades.png" alt="mostrando la funcionalidad de las propiedades" class="img_AMxF"></p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="programando-la-logica-del-servicio-de-windows-windows-service">Programando la logica del servicio de windows (Windows Service)<a href="#programando-la-logica-del-servicio-de-windows-windows-service" class="hash-link" aria-label="Enlace directo al Programando la logica del servicio de windows (Windows Service)" title="Enlace directo al Programando la logica del servicio de windows (Windows Service)">​</a></h2><p>Ahora, vamos a implementar un temporizador y un código para llamar al servicio en un momento determinado. Luego, crearemos un archivo de texto y escribiremos la hora actual en el archivo de texto usando el servicio.</p><p>Bien, vamos a la ventana de la derecha donde se encuentran los archivos del proyecto.
buscamos el archivo llamado <strong>Service1.cs</strong> y damos click izquierdo, luego damos click a la <strong>opcion View Code o Ver Codigo</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/localizando-el-archivo-donde-pondremos-nuestro-codigo.png" alt="localizando el archivo donde pondremos nuestro codigo" class="img_AMxF"></p><p><img loading="lazy" src="/exposition-net-framework/img/wService/indicando-la-opcion-ver-codigo.png" alt="indicando la opcion ver codigo" class="img_AMxF"></p><p>Si todo salio bien, veremos el siguiente codigo.</p><p>Observa bien, hay dos metodos interesantes uno llamado <strong>OnStart</strong> y otro <strong>OnStop</strong> estos metodos pueden estar haciendo referencia a eventos.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_kKve"><div class="admonitionHeading_wtUf"><span class="admonitionIcon_axhX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Los Eventos</div><div class="admonitionContent_NrEf"><p>La programación dirigida por eventos es un paradigma de programación en el que tanto la estructura como la ejecución de los programas van determinados por los sucesos que ocurran en el sistema.</p></div></div><p>En otras palabras los eventos estan en la espera de que algo sucesa. Dicho de forma un poco erronea pero que simplifica la idea principal. </p><p>Al iniciar el servicio el metodo <strong>OnStart</strong> ejecutara el codigo que se le programe y dicho igualmente con el metodo <strong>OnStop</strong>, unicamente que este ultimo se ejecutara cuando el servicio este terminando de ejecutarse.
Esto no quiere decir que el servicio finalice y no siga ejecutandose. Unicamente significa que realizo su tarea y ahora esta en alerta de otra la cual realizar siempre que tenga la misma finalidad por la cual el servicio fue creado.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/Vista-previa-del-codigo.png" alt="Vista previa del codigo" class="img_AMxF"></p><p>El codigo se veria de la siguiente forma.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/logica-finalizada.png" alt="logica finalizada" class="img_AMxF"></p><div class="language-c codeBlockContainer_TkhV theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_FoC1">El codigo completo</div><div class="codeBlockContent_sQUh"><pre tabindex="0" class="prism-code language-c codeBlock_QKyX thin-scrollbar"><code class="codeBlockLines_dfib"><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Collections</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Generic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ComponentModel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Diagnostics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">IO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Linq</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ServiceProcess</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Threading</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Threading</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Tasks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Timers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">namespace MiPrimeraAplicacionDeWindowsService</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public partial class Service1 </span><span class="token operator">:</span><span class="token plain"> ServiceBase</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public </span><span class="token function" style="color:rgb(80, 250, 123)">Service1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">InitializeComponent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        protected override </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">OnStart</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Timers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Timer timer </span><span class="token operator">=</span><span class="token plain"> new System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Timers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Timer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// name space(using System.Timers;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">WriteToFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Service is started at &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> DateTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            timer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Elapsed </span><span class="token operator">+=</span><span class="token plain"> new </span><span class="token function" style="color:rgb(80, 250, 123)">ElapsedEventHandler</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">OnElapsedTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            timer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Interval </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">5000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">//number in milisecinds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            timer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Enabled </span><span class="token operator">=</span><span class="token plain"> true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        protected override </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">OnStop</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">WriteToFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Service is stopped at &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> DateTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        private </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">OnElapsedTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object source</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ElapsedEventArgs e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">WriteToFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Service is recall at &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> DateTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        public </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">WriteToFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string Message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string path </span><span class="token operator">=</span><span class="token plain"> AppDomain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">CurrentDomain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">BaseDirectory </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\\Logs&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">!</span><span class="token plain">Directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Exists</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CreateDirectory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            string filepath </span><span class="token operator">=</span><span class="token plain"> AppDomain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">CurrentDomain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">BaseDirectory </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\\Logs\\ServiceLog_&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> DateTime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Date</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">ToShortDateString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Replace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token char" style="color:rgb(255, 121, 198)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token char" style="color:rgb(255, 121, 198)">&#x27;_&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;.txt&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">!</span><span class="token plain">File</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Exists</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">filepath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token comment" style="color:rgb(98, 114, 164)">// Create a file to write to.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token function" style="color:rgb(80, 250, 123)">using</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">StreamWriter sw </span><span class="token operator">=</span><span class="token plain"> File</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CreateText</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">filepath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    sw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">WriteLine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token function" style="color:rgb(80, 250, 123)">using</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">StreamWriter sw </span><span class="token operator">=</span><span class="token plain"> File</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">AppendText</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">filepath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    sw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">WriteLine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_oSIr"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_Fh8o" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_s6BV"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Hhpu"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_kKve"><div class="admonitionHeading_wtUf"><span class="admonitionIcon_axhX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Que hace el codigo de arriba</div><div class="admonitionContent_NrEf"><p>El código anterior llamará al servicio cada 5 segundos, creará una carpeta si no existe ninguna, entonces escribirá nuestro mensaje.</p></div></div><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="procedimientos-de-busqueda">Procedimientos de busqueda<a href="#procedimientos-de-busqueda" class="hash-link" aria-label="Enlace directo al Procedimientos de busqueda" title="Enlace directo al Procedimientos de busqueda">​</a></h2><p>Bien, ya echo todo. Nos dirigimos a la ventana donde estan nuestros archivos y damos click izquierdo a la carpeta principal del proyecto es decir la que contiene todo los archivos del servicio de windows.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/damos-click-izquierdo-en-nuestro-proyecto.png" alt="damos click izquierdo en nuestro proyecto" class="img_AMxF"></p><p>Se desplegara una ventana con varias opciones, la que nos interesa es la que se llama <strong>Rebuil o Reconstruir</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/creamos-el-rebuild.png" alt="creamos el rebuild" class="img_AMxF"></p><p>Ahora buscamos en el sistema la <strong>Consola de comandos de windows o cmd</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/buscamos-la-consola-de-comandos.png" alt="buscamos la consola de comandos" class="img_AMxF"></p><p>Despues damos click izquierdo en el programa y escogemos la opcion llamada <strong>Run as administrator o Ejutar como administrador</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/ejecutamos-la-consola-de-comandos-como-administrador.png" alt="ejecutamos la consola de comandos como administrador" class="img_AMxF"></p><p>Veremos la siguiente ventana de fondo negro, conocida tambien de la siguientes formas <strong>cmd, consola de comandos, terminal</strong></p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mostramos-la-consola-de-comandos.png" alt="mostramos la consola de comandos" class="img_AMxF"></p><p>Ahora, escribe el siguiente comando y luego presionas enter.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/ejecutamos-el-comando-para-ubicarnos-en-la-carpeta-que-buscamos.png" alt="ejecutamos el comando para ubicarnos en la carpeta que buscamos" class="img_AMxF"></p><div class="language-bash codeBlockContainer_TkhV theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_sQUh"><pre tabindex="0" class="prism-code language-bash codeBlock_QKyX thin-scrollbar"><code class="codeBlockLines_dfib"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> C:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">Microsoft.NET</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">Framework</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">v4.0.30319 </span><br></span></code></pre><div class="buttonGroup_oSIr"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_Fh8o" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_s6BV"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Hhpu"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_kKve"><div class="admonitionHeading_wtUf"><span class="admonitionIcon_axhX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Que hace el comando de arriba?</div><div class="admonitionContent_NrEf"><p>El comando anterior indica que queremos buscar una carpeta en el sistema alojada en una ruta especifica, si la encuentra nos ubicaremos en ella desde la <strong>consola de comandos</strong> de lo contrario nos arrojara un error de que la carpeta que buscamos no existe.</p></div></div><p>Despues, nos dirigimos a nuestro proyecto una vez mas y despues le damos click izquierdo a la carpeta principal del servicio que estamos creando.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/damos-click-izquierdo-en-nuestro-proyecto.png" alt="damos click izquierdo en nuestro proyecto" class="img_AMxF"></p><p>Ahora escogemos la opcion <strong>Open Folder in File Explorer o Abrir Ubicacion del la Carpeta</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/seleccionando-opcion-abrir-ubicacion-del-proyecto.png" alt="seleccionando opcion abrir ubicacion del proyecto" class="img_AMxF"></p><p>Se abrira el <strong>Explorador de Archivos de Windows</strong> y te mostrara donde estan ubicados todos los archivos del servicio.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/panorama-de-la-carpeta-del-servicio.png" alt="panorama de la carpeta del servicio" class="img_AMxF"></p><p>Despues nos dirigimos a la seccion superior donde esta el nombre del servicio que creamos y damos click sobre el nombre.
Se desplegara un codigo con fondo azul el cual tienes que copiar, ya que sera de gran importancia.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/copiando-ruta-del-directorio.png" alt="copiando ruta del directorio" class="img_AMxF"></p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="instalando-el-servicio">Instalando el servicio<a href="#instalando-el-servicio" class="hash-link" aria-label="Enlace directo al Instalando el servicio" title="Enlace directo al Instalando el servicio">​</a></h2><p><img loading="lazy" src="/exposition-net-framework/img/wService/instalando-nuestro-servicio.png" alt="instalando nuestro servicio" class="img_AMxF"></p><div class="language-bash codeBlockContainer_TkhV theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_sQUh"><pre tabindex="0" class="prism-code language-bash codeBlock_QKyX thin-scrollbar"><code class="codeBlockLines_dfib"><span class="token-line" style="color:#F8F8F2"><span class="token plain">InstallUtil.exe C:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">ferna</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">repos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">MiPrimeraAplicacionDeWindowsService</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">MiPrimeraAplicacionDeWindowsService</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">bin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">Debug</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">MiPrimeraAplicacionDeWindowsService.exe</span><br></span></code></pre><div class="buttonGroup_oSIr"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_Fh8o" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_s6BV"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_Hhpu"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Bien, damos enter y si todo salio bien, tendras unos mensajes como los siguientes. Diciendonos que la instalacion fue exitosa.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/verificamos-si-la-instalacion-fue-exitosa.png" alt="verificamos si la instalacion fue exitosa" class="img_AMxF"></p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="verificamos-el-servicio">Verificamos el servicio<a href="#verificamos-el-servicio" class="hash-link" aria-label="Enlace directo al Verificamos el servicio" title="Enlace directo al Verificamos el servicio">​</a></h2><p><img loading="lazy" src="/exposition-net-framework/img/wService/verificamos-si-la-instalacion-fue-exitosa.png" alt="verificamos si la instalacion fue exitosa" class="img_AMxF"></p><p>Nos dirigimos a buscar los servicios de windows <strong>(services o servicios)</strong>, damos click en la opcion de tuerca.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/buscando-los-servicios-de-windows.png" alt="buscando los servicios de windows" class="img_AMxF"></p><p>Ahora, buscamos nuestro servicio.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/buscamos-nuestro-servicio.png" alt="buscamos nuestro servicio" class="img_AMxF"></p><p>Damos click izquierdo sobre nuestro servicio y seleccionamos la opcion <strong>properties o propiedades</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/configuracion-por-defecto-en-las-propiedades-del-servicio.png" alt="configuracion por defecto en las propiedades del servicio" class="img_AMxF"></p><p>Despues aparecera una ventana con unas propiedades por defecto.</p><p>Necesitamos cambiar la opcion de <strong>This Account</strong> a <strong>Local System Account</strong>, damos click en <strong>apply</strong> o <strong>aplicar</strong> y guardamos los cambios.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/cambiando-opcion-a-localSystemAccount.png" alt="cambiando opcion a localSystemAccount" class="img_AMxF"></p><p>Despues de configurar las propiedades del servicio, damos click en <strong>start o iniciar</strong>. Esta opcion se encuentra en la parte superior de la ventana.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/iniciando-el-servicio.png" alt="iniciando el servicio" class="img_AMxF"></p><p>Inmediatamente las opciones del servicio cambiaran a <strong>Stop</strong> y <strong>Restart</strong> o <strong>Parar</strong> y <strong>Reiniciar</strong>.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/se-habilitan-dos-opciones-para-el-servicio.png" alt="se habilitan dos opciones para el servicio" class="img_AMxF"></p><h2 class="anchor anchorWithStickyNavbar_c6Kk" id="resultado-final">Resultado Final<a href="#resultado-final" class="hash-link" aria-label="Enlace directo al Resultado Final" title="Enlace directo al Resultado Final">​</a></h2><p>Borro la carpeta y a los segundos vulve a aparecer sin crearla yo mismo, eso es gracias al servicio que estaba en funcionamiento y como puedes ver cada 5 segundos le agregaba texto extra al archivo de text llamado log.</p><p><img loading="lazy" src="/exposition-net-framework/img/wService/mostrando-servicio-de-windows.gif" alt="mostrando servicio de windows" class="img_AMxF"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Página del documento"><a class="pagination-nav__link pagination-nav__link--prev" href="/exposition-net-framework/docs/Sergio"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">Sergio - WPF</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/exposition-net-framework/docs/Alex-front"><div class="pagination-nav__sublabel">Siguiente</div><div class="pagination-nav__label">Alex - ASP.NET (Front)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Z2nN thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#qué-es-un-servicio-de-windows" class="table-of-contents__link toc-highlight">¿Qué es un servicio de Windows?</a></li><li><a href="#empezamos" class="table-of-contents__link toc-highlight">Empezamos</a><ul><li><a href="#panorama-principal-al-iniciar-el-proyecto" class="table-of-contents__link toc-highlight">Panorama principal al iniciar el proyecto.</a></li></ul></li><li><a href="#agregar-un-instalador-para-windows-server" class="table-of-contents__link toc-highlight">Agregar un instalador para windows server</a></li><li><a href="#modificando-propiedades-del-servicio" class="table-of-contents__link toc-highlight">Modificando propiedades del servicio</a></li><li><a href="#programando-la-logica-del-servicio-de-windows-windows-service" class="table-of-contents__link toc-highlight">Programando la logica del servicio de windows (Windows Service)</a></li><li><a href="#procedimientos-de-busqueda" class="table-of-contents__link toc-highlight">Procedimientos de busqueda</a></li><li><a href="#instalando-el-servicio" class="table-of-contents__link toc-highlight">Instalando el servicio</a></li><li><a href="#verificamos-el-servicio" class="table-of-contents__link toc-highlight">Verificamos el servicio</a></li><li><a href="#resultado-final" class="table-of-contents__link toc-highlight">Resultado Final</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QQay"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QQay"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QQay"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QQay"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/exposition-net-framework/assets/js/runtime~main.6b82afc8.js"></script>
<script src="/exposition-net-framework/assets/js/main.b1947578.js"></script>
</body>
</html>