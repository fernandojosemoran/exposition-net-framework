"use strict";(self.webpackChunkpresentation_net_framework=self.webpackChunkpresentation_net_framework||[]).push([[427],{9613:(e,a,o)=>{o.d(a,{Zo:()=>d,kt:()=>g});var n=o(9496);function r(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function i(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,n)}return o}function t(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?i(Object(o),!0).forEach((function(a){r(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function s(e,a){if(null==e)return{};var o,n,r=function(e,a){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],a.indexOf(o)>=0||(r[o]=e[o]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var l=n.createContext({}),c=function(e){var a=n.useContext(l),o=a;return e&&(o="function"==typeof e?e(a):t(t({},a),e)),o},d=function(e){var a=c(e.components);return n.createElement(l.Provider,{value:a},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var o=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(o),u=r,g=p["".concat(l,".").concat(u)]||p[u]||m[u]||i;return o?n.createElement(g,t(t({ref:a},d),{},{components:o})):n.createElement(g,t({ref:a},d))}));function g(e,a){var o=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var i=o.length,t=new Array(i);t[0]=u;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s[p]="string"==typeof e?e:r,t[1]=s;for(var c=2;c<i;c++)t[c]=o[c];return n.createElement.apply(null,t)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},7239:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>l,contentTitle:()=>t,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var n=o(8028),r=(o(9496),o(9613));const i={sidebar_position:3,title:"Fernando - Windows Service"},t=void 0,s={unversionedId:"Fernando",id:"Fernando",title:"Fernando - Windows Service",description:"\xbfQu\xe9 es un servicio de Windows?",source:"@site/docs/Fernando.md",sourceDirName:".",slug:"/Fernando",permalink:"/exposition-net-framework/docs/Fernando",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Fernando - Windows Service"},sidebar:"tutorialSidebar",previous:{title:"Sergio - WPF",permalink:"/exposition-net-framework/docs/Sergio"},next:{title:"Sin Asignar - Aplicacion de consola",permalink:"/exposition-net-framework/docs/Desconocido"}},l={},c=[{value:"\xbfQu\xe9 es un servicio de Windows?",id:"qu\xe9-es-un-servicio-de-windows",level:2},{value:"Empezamos",id:"empezamos",level:2},{value:"Panorama principal al iniciar el proyecto.",id:"panorama-principal-al-iniciar-el-proyecto",level:3},{value:"Agregar un instalador para windows server",id:"agregar-un-instalador-para-windows-server",level:2},{value:"Modificando propiedades del servicio",id:"modificando-propiedades-del-servicio",level:2}],d={toc:c},p="wrapper";function m(e){let{components:a,...o}=e;return(0,r.kt)(p,(0,n.Z)({},d,o,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c#"},"using System.ComponentModel;\n")),(0,r.kt)("h2",{id:"qu\xe9-es-un-servicio-de-windows"},"\xbfQu\xe9 es un servicio de Windows?"),(0,r.kt)("p",null,"Los servicios de Windows son aplicaciones de software que no son UI y que se ejecutan en segundo plano. Los servicios de Windows generalmente se inician cuando se inicia un sistema operativo y est\xe1 programado para ejecutarse en segundo plano para ejecutar algunas tareas. Los servicios de Windows tambi\xe9n se pueden iniciar de forma autom\xe1tica o manual. Tambi\xe9n puede pausar, detener y reiniciar manualmente los servicios de Windows."),(0,r.kt)("p",null,"El servicio de Windows es un programa inform\xe1tico que se ejecuta en segundo plano para ejecutar algunas tareas. Algunos ejemplos de servicios de Windows son la actualizaci\xf3n autom\xe1tica de Windows, consultar correos electr\xf3nicos, imprimir documentos, el Agente SQL Server, escaneo e indexaci\xf3n de archivos y carpetas, etc. Si abre el Administrador de tareas y hace clic en la pesta\xf1a Servicios, ver\xe1 cientos de servicios. ejecut\xe1ndose en su m\xe1quina. Tambi\xe9n puede ver los estados de estos servicios. Algunos servicios se est\xe1n ejecutando, otros se han detenido y otros se han detenido. Puede iniciar, detener y pausar un servicio desde aqu\xed haciendo clic derecho en el servicio."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/servicios-de-windows.jpg",alt:"servicios de windows"})),(0,r.kt)("h2",{id:"empezamos"},"Empezamos"),(0,r.kt)("p",null,"Buscamos ",(0,r.kt)("strong",{parentName:"p"},"Windows Service")," y escogemos la opcion que dice ",(0,r.kt)("em",{parentName:"p"},".net framework"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/Buscando-tecnologia-de-windows-service.png",alt:"Buscando tecnologia de windows service"})),(0,r.kt)("p",null,"Despues nombramos nuestro proyecto."),(0,r.kt)("admonition",{title:"Nombra de forma correcta tus proyectos",type:"note"},(0,r.kt)("p",{parentName:"admonition"},"No uses espacios en blanco, por ejemplo ",(0,r.kt)("strong",{parentName:"p"},"(No llames tu proyecto asi)"),". Ademas no uses caracteres raros como ",(0,r.kt)("strong",{parentName:"p"},"?%$^()][{}#&")," entre otros solo usa letras del alfabeto, recomendablemente solo del alfabero americano.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/nombrando-nuestro-proyecto-de-windows-service.png",alt:"nombrando nuestro proyecto de windows service"})),(0,r.kt)("h3",{id:"panorama-principal-al-iniciar-el-proyecto"},"Panorama principal al iniciar el proyecto."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/panorama-de-inicio-del-proyecto.png",alt:"panorama de inicio del proyecto"})),(0,r.kt)("p",null,"Nos indica que debemos arrastrar un elemento de la caja de herramientas asi la interfaz grafica o canvas."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"Alex"},"Como activar la toolbox o caja de herramientas")),", Recuerda ir a la seccion de ",(0,r.kt)("strong",{parentName:"p"},"Activamos las ventana de caja de herramientas"),"."),(0,r.kt)("h2",{id:"agregar-un-instalador-para-windows-server"},"Agregar un instalador para windows server"),(0,r.kt)("p",null,"Para agregar un instalador, debemos dar click izquierdo y se desplegara una ventana con opciones.\nA nosotros nos interesa la que dice ",(0,r.kt)("strong",{parentName:"p"},"Add Installer o Agregar Instalador"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/agregar-un-instalador.png",alt:"agregar un instalador"})),(0,r.kt)("p",null,"Despues tendremos un panorama de una pestalla abierta."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/vista-previa-despues-de-hacer-click-en-agregar-instalador.png",alt:"vista previa despues de hacer click en agregar instalador"})),(0,r.kt)("p",null,"Esta pesta\xf1a hace referencia al archivo que se creo al agregar el installer. Tu puedes verlo mirando los archivos del proyecto."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-instalador-creado.png",alt:"mostrando instalador creado"})),(0,r.kt)("p",null,"Bien, ahora observemos el codigo fuente del installer o instalador.\nPara eso damos click izquierdo y click a la opcion que dice ",(0,r.kt)("strong",{parentName:"p"},"View Code o Ver Codigo"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/seleccionando-la-opcion-de-ver-codigo.png",alt:"seleccionando la opcion de ver codigo"})),(0,r.kt)("p",null,"El codigo del installer o instalador se miraria de la siguiente forma."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mirando-el-codigo-fuente-del-instalador.png",alt:"mirando el codigo fuente del instalador"})),(0,r.kt)("p",null,"Vamos a explicar lo que se\xf1ala las flechas"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"La flecha roja indica a que grupo de logica de codigo pertenece, por ejemplo el installer o instalador pertenece a la misma logica de programacion a la que pertenece nuestra interfaz grafica o interfaz de aplicacion. \n")),(0,r.kt)("p",null,"La fecha verde "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"La flecha verder indica el nombre del la clase que hace posible que el installer o instalador exista, ademas hace uso de un metodo que inicializa el instalador.\n")),(0,r.kt)("p",null,"Bueno verifiquemos si en realidad pertenece a la mismo campo de logica que el installer o instalador."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-codigo-del-windows-servicio.png",alt:"mostrando codigo del windows servicio"})),(0,r.kt)("h2",{id:"modificando-propiedades-del-servicio"},"Modificando propiedades del servicio"),(0,r.kt)("p",null,"Ahora Observemos las propiedades mediante el codigo del componente que instancia el metodo de disponse.\nPara eso debes de poner el puntero del mouse en el componente marcado en rojo y pretar ",(0,r.kt)("strong",{parentName:"p"},"la tecla control + click")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-componente-o-funcion-a-ver-codigo.png",alt:"mostrando componente o funcion a ver codigo"})),(0,r.kt)("p",null,"Si has echo todo bien, podras ver el codigo que compone internamente el componente ",(0,r.kt)("strong",{parentName:"p"},"InitializeComponent();"),"."),(0,r.kt)("p",null,"Podras notar con las flecha de color rojo el nombre del servicio.\nY con el lo que esta marcado de verde algunas propiedades que conforman el servicio."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/observando-codigo-del-componente-que-inicializaba-el-metodo-del-installer-o-instalador.png",alt:"observando codigo del componente que inicializaba el metodo del installer o instalador"})),(0,r.kt)("p",null,"Perfecto, agregamos una propiedad de cuenta al componente y le asignamos un valor indicandole que es un servicio local."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/agregamos-una-propiedad-y-le-asignamos-un-valor.png",alt:"agregamos una propiedad y le asignamos un valor"})),(0,r.kt)("p",null,"Bien, vamos a agregar dos propiedades mas que son fundamentales para los servicios de windows, ya que son indentificadores visuales."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/agregando-otras-propiedades-excensiales.png",alt:"agregando otras propiedades excensiales"})),(0,r.kt)("p",null,"A que te hace sentido la propiedad ",(0,r.kt)("strong",{parentName:"p"},"Description y DisplayName"),". Bueno si eres informatico, alguna vez escuchastes o has abierto los servicios de windows, aunque no sepas con exactitud sus funcionalidades. las propiedades anteriores hacen referencia a los campos principales de la ventana de servicios de windows."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-la-funcionalidad-de-las-propiedades.png",alt:"mostrando la funcionalidad de las propiedades"})),(0,r.kt)("p",null,"Ahora, vamos a implementar un temporizador y un c\xf3digo para llamar al servicio en un momento determinado. Luego, crearemos un archivo de texto y escribiremos la hora actual en el archivo de texto usando el servicio."))}m.isMDXComponent=!0}}]);