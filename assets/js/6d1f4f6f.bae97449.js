"use strict";(self.webpackChunkpresentation_net_framework=self.webpackChunkpresentation_net_framework||[]).push([[607],{9613:(e,a,o)=>{o.d(a,{Zo:()=>p,kt:()=>g});var n=o(9496);function i(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function r(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,n)}return o}function t(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?r(Object(o),!0).forEach((function(a){i(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function s(e,a){if(null==e)return{};var o,n,i=function(e,a){if(null==e)return{};var o,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],a.indexOf(o)>=0||(i[o]=e[o]);return i}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var l=n.createContext({}),c=function(e){var a=n.useContext(l),o=a;return e&&(o="function"==typeof e?e(a):t(t({},a),e)),o},p=function(e){var a=c(e.components);return n.createElement(l.Provider,{value:a},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var o=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(o),u=i,g=d["".concat(l,".").concat(u)]||d[u]||m[u]||r;return o?n.createElement(g,t(t({ref:a},p),{},{components:o})):n.createElement(g,t({ref:a},p))}));function g(e,a){var o=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var r=o.length,t=new Array(r);t[0]=u;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s[d]="string"==typeof e?e:i,t[1]=s;for(var c=2;c<r;c++)t[c]=o[c];return n.createElement.apply(null,t)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},3099:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>l,contentTitle:()=>t,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=o(8028),i=(o(9496),o(9613));const r={sidebar_position:3,title:"Fernando - Windows Service"},t=void 0,s={unversionedId:"Fernando",id:"Fernando",title:"Fernando - Windows Service",description:"\xbfQu\xe9 es un servicio de Windows?",source:"@site/docs/3-Fernando.md",sourceDirName:".",slug:"/Fernando",permalink:"/exposition-net-framework/docs/Fernando",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Fernando - Windows Service"},sidebar:"tutorialSidebar",previous:{title:"Sergio - WPF",permalink:"/exposition-net-framework/docs/Sergio"},next:{title:"Sin Asignar - ASP.NET (Front)",permalink:"/exposition-net-framework/docs/Desconocido3"}},l={},c=[{value:"\xbfQu\xe9 es un servicio de Windows?",id:"qu\xe9-es-un-servicio-de-windows",level:2},{value:"Empezamos",id:"empezamos",level:2},{value:"Panorama principal al iniciar el proyecto.",id:"panorama-principal-al-iniciar-el-proyecto",level:3},{value:"Agregar un instalador para windows server",id:"agregar-un-instalador-para-windows-server",level:2},{value:"Modificando propiedades del servicio",id:"modificando-propiedades-del-servicio",level:2},{value:"Programando la logica del servicio de windows (Windows Service)",id:"programando-la-logica-del-servicio-de-windows-windows-service",level:2},{value:"Procedimientos de busqueda",id:"procedimientos-de-busqueda",level:2},{value:"Instalando el servicio",id:"instalando-el-servicio",level:2},{value:"Verificamos el servicio",id:"verificamos-el-servicio",level:2},{value:"Resultado Final",id:"resultado-final",level:2}],p={toc:c},d="wrapper";function m(e){let{components:a,...o}=e;return(0,i.kt)(d,(0,n.Z)({},p,o,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-c#",metastring:'title="Este ejemplo hace uso de las siguientes librerias"',title:'"Este',ejemplo:!0,hace:!0,uso:!0,de:!0,las:!0,siguientes:!0,'librerias"':!0},"using System.ComponentModel;\nusing System.ServiceProcess;\nusing System.Timers;\nusing System.IO;\nusing System;\n")),(0,i.kt)("h2",{id:"qu\xe9-es-un-servicio-de-windows"},"\xbfQu\xe9 es un servicio de Windows?"),(0,i.kt)("p",null,"Los servicios de Windows son aplicaciones de software que no son UI y que se ejecutan en segundo plano. Los servicios de Windows generalmente se inician cuando se inicia un sistema operativo y est\xe1 programado para ejecutarse en segundo plano para ejecutar algunas tareas. Los servicios de Windows tambi\xe9n se pueden iniciar de forma autom\xe1tica o manual. Tambi\xe9n puede pausar, detener y reiniciar manualmente los servicios de Windows."),(0,i.kt)("p",null,"El servicio de Windows es un programa inform\xe1tico que se ejecuta en segundo plano para ejecutar algunas tareas. Algunos ejemplos de servicios de Windows son la actualizaci\xf3n autom\xe1tica de Windows, consultar correos electr\xf3nicos, imprimir documentos, el Agente SQL Server, escaneo e indexaci\xf3n de archivos y carpetas, etc. Si abre el Administrador de tareas y hace clic en la pesta\xf1a Servicios, ver\xe1 cientos de servicios. ejecut\xe1ndose en su m\xe1quina. Tambi\xe9n puede ver los estados de estos servicios. Algunos servicios se est\xe1n ejecutando, otros se han detenido y otros se han detenido. Puede iniciar, detener y pausar un servicio desde aqu\xed haciendo clic derecho en el servicio."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/servicios-de-windows.jpg",alt:"servicios de windows"})),(0,i.kt)("h2",{id:"empezamos"},"Empezamos"),(0,i.kt)("p",null,"Buscamos ",(0,i.kt)("strong",{parentName:"p"},"Windows Service")," y escogemos la opcion que dice ",(0,i.kt)("em",{parentName:"p"},".net framework"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/Buscando-tecnologia-de-windows-service.png",alt:"Buscando tecnologia de windows service"})),(0,i.kt)("p",null,"Despues nombramos nuestro proyecto."),(0,i.kt)("admonition",{title:"Nombra de forma correcta tus proyectos",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"No uses espacios en blanco, por ejemplo ",(0,i.kt)("strong",{parentName:"p"},"(No llames tu proyecto asi)"),". Ademas no uses caracteres raros como ",(0,i.kt)("strong",{parentName:"p"},"?%$^()][{}#&")," entre otros solo usa letras del alfabeto, recomendablemente solo del alfabero americano.")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/nombrando-nuestro-proyecto-de-windows-service.png",alt:"nombrando nuestro proyecto de windows service"})),(0,i.kt)("h3",{id:"panorama-principal-al-iniciar-el-proyecto"},"Panorama principal al iniciar el proyecto."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/panorama-de-inicio-del-proyecto.png",alt:"panorama de inicio del proyecto"})),(0,i.kt)("p",null,"Nos indica que debemos arrastrar un elemento de la caja de herramientas asi la interfaz grafica o canvas."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("a",{parentName:"em",href:"Alex"},"Como activar la toolbox o caja de herramientas")),", Recuerda ir a la seccion de ",(0,i.kt)("strong",{parentName:"p"},"Activamos las ventana de caja de herramientas"),"."),(0,i.kt)("h2",{id:"agregar-un-instalador-para-windows-server"},"Agregar un instalador para windows server"),(0,i.kt)("p",null,"Para agregar un instalador, debemos dar click izquierdo y se desplegara una ventana con opciones.\nA nosotros nos interesa la que dice ",(0,i.kt)("strong",{parentName:"p"},"Add Installer o Agregar Instalador"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/agregar-un-instalador.png",alt:"agregar un instalador"})),(0,i.kt)("p",null,"Despues tendremos un panorama de una pestalla abierta."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/vista-previa-despues-de-hacer-click-en-agregar-instalador.png",alt:"vista previa despues de hacer click en agregar instalador"})),(0,i.kt)("p",null,"Esta pesta\xf1a hace referencia al archivo que se creo al agregar el installer. Tu puedes verlo mirando los archivos del proyecto."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-instalador-creado.png",alt:"mostrando instalador creado"})),(0,i.kt)("p",null,"Bien, ahora observemos el codigo fuente del installer o instalador.\nPara eso damos click izquierdo y click a la opcion que dice ",(0,i.kt)("strong",{parentName:"p"},"View Code o Ver Codigo"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/seleccionando-la-opcion-de-ver-codigo.png",alt:"seleccionando la opcion de ver codigo"})),(0,i.kt)("p",null,"El codigo del installer o instalador se miraria de la siguiente forma."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mirando-el-codigo-fuente-del-instalador.png",alt:"mirando el codigo fuente del instalador"})),(0,i.kt)("p",null,"Vamos a explicar lo que se\xf1ala las flechas"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"La flecha roja indica a que grupo de logica de codigo pertenece, por ejemplo el installer o instalador pertenece a la misma logica de programacion a la que pertenece nuestra interfaz grafica o interfaz de aplicacion. \n")),(0,i.kt)("p",null,"La fecha verde "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"La flecha verder indica el nombre del la clase que hace posible que el installer o instalador exista, ademas hace uso de un metodo que inicializa el instalador.\n")),(0,i.kt)("p",null,"Bueno verifiquemos si en realidad pertenece a la mismo campo de logica que el installer o instalador."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-codigo-del-windows-servicio.png",alt:"mostrando codigo del windows servicio"})),(0,i.kt)("h2",{id:"modificando-propiedades-del-servicio"},"Modificando propiedades del servicio"),(0,i.kt)("p",null,"Ahora Observemos las propiedades mediante el codigo del componente que instancia el metodo de disponse.\nPara eso debes de poner el puntero del mouse en el componente marcado en rojo y pretar ",(0,i.kt)("strong",{parentName:"p"},"la tecla control + click")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-componente-o-funcion-a-ver-codigo.png",alt:"mostrando componente o funcion a ver codigo"})),(0,i.kt)("p",null,"Si has echo todo bien, podras ver el codigo que compone internamente el componente ",(0,i.kt)("strong",{parentName:"p"},"InitializeComponent();"),"."),(0,i.kt)("p",null,"Podras notar con las flecha de color rojo el nombre del servicio.\nY con el lo que esta marcado de verde algunas propiedades que conforman el servicio."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/observando-codigo-del-componente-que-inicializaba-el-metodo-del-installer-o-instalador.png",alt:"observando codigo del componente que inicializaba el metodo del installer o instalador"})),(0,i.kt)("p",null,"Perfecto, agregamos una propiedad de cuenta al componente y le asignamos un valor indicandole que es un servicio local."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/agregamos-una-propiedad-y-le-asignamos-un-valor.png",alt:"agregamos una propiedad y le asignamos un valor"})),(0,i.kt)("p",null,"Bien, vamos a agregar dos propiedades mas que son fundamentales para los servicios de windows, ya que son indentificadores visuales."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/agregando-otras-propiedades-excensiales.png",alt:"agregando otras propiedades excensiales"})),(0,i.kt)("p",null,"A que te hace sentido la propiedad ",(0,i.kt)("strong",{parentName:"p"},"Description y DisplayName"),". Bueno si eres informatico, alguna vez escuchastes o has abierto los servicios de windows, aunque no sepas con exactitud sus funcionalidades. las propiedades anteriores hacen referencia a los campos principales de la ventana de servicios de windows."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-la-funcionalidad-de-las-propiedades.png",alt:"mostrando la funcionalidad de las propiedades"})),(0,i.kt)("h2",{id:"programando-la-logica-del-servicio-de-windows-windows-service"},"Programando la logica del servicio de windows (Windows Service)"),(0,i.kt)("p",null,"Ahora, vamos a implementar un temporizador y un c\xf3digo para llamar al servicio en un momento determinado. Luego, crearemos un archivo de texto y escribiremos la hora actual en el archivo de texto usando el servicio."),(0,i.kt)("p",null,"Bien, vamos a la ventana de la derecha donde se encuentran los archivos del proyecto.\nbuscamos el archivo llamado ",(0,i.kt)("strong",{parentName:"p"},"Service1.cs")," y damos click izquierdo, luego damos click a la ",(0,i.kt)("strong",{parentName:"p"},"opcion View Code o Ver Codigo"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/localizando-el-archivo-donde-pondremos-nuestro-codigo.png",alt:"localizando el archivo donde pondremos nuestro codigo"})),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/indicando-la-opcion-ver-codigo.png",alt:"indicando la opcion ver codigo"})),(0,i.kt)("p",null,"Si todo salio bien, veremos el siguiente codigo."),(0,i.kt)("p",null,"Observa bien, hay dos metodos interesantes uno llamado ",(0,i.kt)("strong",{parentName:"p"},"OnStart")," y otro ",(0,i.kt)("strong",{parentName:"p"},"OnStop")," estos metodos pueden estar haciendo referencia a eventos."),(0,i.kt)("admonition",{title:"Los Eventos",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"La programaci\xf3n dirigida por eventos es un paradigma de programaci\xf3n en el que tanto la estructura como la ejecuci\xf3n de los programas van determinados por los sucesos que ocurran en el sistema.")),(0,i.kt)("p",null,"En otras palabras los eventos estan en la espera de que algo sucesa. Dicho de forma un poco erronea pero que simplifica la idea principal. "),(0,i.kt)("p",null,"Al iniciar el servicio el metodo ",(0,i.kt)("strong",{parentName:"p"},"OnStart")," ejecutara el codigo que se le programe y dicho igualmente con el metodo ",(0,i.kt)("strong",{parentName:"p"},"OnStop"),", unicamente que este ultimo se ejecutara cuando el servicio este terminando de ejecutarse.\nEsto no quiere decir que el servicio finalice y no siga ejecutandose. Unicamente significa que realizo su tarea y ahora esta en alerta de otra la cual realizar siempre que tenga la misma finalidad por la cual el servicio fue creado."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/Vista-previa-del-codigo.png",alt:"Vista previa del codigo"})),(0,i.kt)("p",null,"El codigo se veria de la siguiente forma."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/logica-finalizada.png",alt:"logica finalizada"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-c",metastring:'title="El codigo completo"',title:'"El',codigo:!0,'completo"':!0},'using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Linq;\nusing System.ServiceProcess;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing System.Timers;\n\nnamespace MiPrimeraAplicacionDeWindowsService\n{\n    public partial class Service1 : ServiceBase\n    {\n        public Service1()\n        {\n            InitializeComponent();\n        }\n\n        protected override void OnStart(string[] args)\n        {\n            System.Timers.Timer timer = new System.Timers.Timer(); // name space(using System.Timers;)\n            WriteToFile("Service is started at " + DateTime.Now);\n            timer.Elapsed += new ElapsedEventHandler(OnElapsedTime);\n            timer.Interval = 5000; //number in milisecinds\n            timer.Enabled = true;\n        }\n\n        protected override void OnStop()\n        {\n            WriteToFile("Service is stopped at " + DateTime.Now);\n        }\n\n        private void OnElapsedTime(object source, ElapsedEventArgs e)\n        {\n            WriteToFile("Service is recall at " + DateTime.Now);\n        }\n        public void WriteToFile(string Message)\n        {\n            string path = AppDomain.CurrentDomain.BaseDirectory + "\\\\Logs";\n            if (!Directory.Exists(path))\n            {\n                Directory.CreateDirectory(path);\n            }\n            string filepath = AppDomain.CurrentDomain.BaseDirectory + "\\\\Logs\\\\ServiceLog_" + DateTime.Now.Date.ToShortDateString().Replace(\'/\', \'_\') + ".txt";\n            if (!File.Exists(filepath))\n            {\n                // Create a file to write to.\n                using (StreamWriter sw = File.CreateText(filepath))\n                {\n                    sw.WriteLine(Message);\n                }\n            }\n            else\n            {\n                using (StreamWriter sw = File.AppendText(filepath))\n                {\n                    sw.WriteLine(Message);\n                }\n            }\n        }\n\n    }\n}\n')),(0,i.kt)("admonition",{title:"Que hace el codigo de arriba",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"El c\xf3digo anterior llamar\xe1 al servicio cada 5 segundos, crear\xe1 una carpeta si no existe ninguna, entonces escribir\xe1 nuestro mensaje.")),(0,i.kt)("h2",{id:"procedimientos-de-busqueda"},"Procedimientos de busqueda"),(0,i.kt)("p",null,"Bien, ya echo todo. Nos dirigimos a la ventana donde estan nuestros archivos y damos click izquierdo a la carpeta principal del proyecto es decir la que contiene todo los archivos del servicio de windows."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/damos-click-izquierdo-en-nuestro-proyecto.png",alt:"damos click izquierdo en nuestro proyecto"})),(0,i.kt)("p",null,"Se desplegara una ventana con varias opciones, la que nos interesa es la que se llama ",(0,i.kt)("strong",{parentName:"p"},"Rebuil o Reconstruir"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/creamos-el-rebuild.png",alt:"creamos el rebuild"})),(0,i.kt)("p",null,"Ahora buscamos en el sistema la ",(0,i.kt)("strong",{parentName:"p"},"Consola de comandos de windows o cmd"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/buscamos-la-consola-de-comandos.png",alt:"buscamos la consola de comandos"})),(0,i.kt)("p",null,"Despues damos click izquierdo en el programa y escogemos la opcion llamada ",(0,i.kt)("strong",{parentName:"p"},"Run as administrator o Ejutar como administrador"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/ejecutamos-la-consola-de-comandos-como-administrador.png",alt:"ejecutamos la consola de comandos como administrador"})),(0,i.kt)("p",null,"Veremos la siguiente ventana de fondo negro, conocida tambien de la siguientes formas ",(0,i.kt)("strong",{parentName:"p"},"cmd, consola de comandos, terminal")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostramos-la-consola-de-comandos.png",alt:"mostramos la consola de comandos"})),(0,i.kt)("p",null,"Ahora, escribe el siguiente comando y luego presionas enter."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/ejecutamos-el-comando-para-ubicarnos-en-la-carpeta-que-buscamos.png",alt:"ejecutamos el comando para ubicarnos en la carpeta que buscamos"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cd C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319 \n")),(0,i.kt)("admonition",{title:"Que hace el comando de arriba?",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"El comando anterior indica que queremos buscar una carpeta en el sistema alojada en una ruta especifica, si la encuentra nos ubicaremos en ella desde la ",(0,i.kt)("strong",{parentName:"p"},"consola de comandos")," de lo contrario nos arrojara un error de que la carpeta que buscamos no existe.")),(0,i.kt)("p",null,"Despues, nos dirigimos a nuestro proyecto una vez mas y despues le damos click izquierdo a la carpeta principal del servicio que estamos creando."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/damos-click-izquierdo-en-nuestro-proyecto.png",alt:"damos click izquierdo en nuestro proyecto"})),(0,i.kt)("p",null,"Ahora escogemos la opcion ",(0,i.kt)("strong",{parentName:"p"},"Open Folder in File Explorer o Abrir Ubicacion del la Carpeta"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/seleccionando-opcion-abrir-ubicacion-del-proyecto.png",alt:"seleccionando opcion abrir ubicacion del proyecto"})),(0,i.kt)("p",null,"Se abrira el ",(0,i.kt)("strong",{parentName:"p"},"Explorador de Archivos de Windows")," y te mostrara donde estan ubicados todos los archivos del servicio."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/panorama-de-la-carpeta-del-servicio.png",alt:"panorama de la carpeta del servicio"})),(0,i.kt)("p",null,"Despues nos dirigimos a la seccion superior donde esta el nombre del servicio que creamos y damos click sobre el nombre.\nSe desplegara un codigo con fondo azul el cual tienes que copiar, ya que sera de gran importancia."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/copiando-ruta-del-directorio.png",alt:"copiando ruta del directorio"})),(0,i.kt)("h2",{id:"instalando-el-servicio"},"Instalando el servicio"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/instalando-nuestro-servicio.png",alt:"instalando nuestro servicio"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"InstallUtil.exe C:\\Users\\ferna\\source\\repos\\MiPrimeraAplicacionDeWindowsService\\MiPrimeraAplicacionDeWindowsService\\bin\\Debug\\MiPrimeraAplicacionDeWindowsService.exe\n")),(0,i.kt)("p",null,"Bien, damos enter y si todo salio bien, tendras unos mensajes como los siguientes. Diciendonos que la instalacion fue exitosa."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/verificamos-si-la-instalacion-fue-exitosa.png",alt:"verificamos si la instalacion fue exitosa"})),(0,i.kt)("h2",{id:"verificamos-el-servicio"},"Verificamos el servicio"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/verificamos-si-la-instalacion-fue-exitosa.png",alt:"verificamos si la instalacion fue exitosa"})),(0,i.kt)("p",null,"Nos dirigimos a buscar los servicios de windows ",(0,i.kt)("strong",{parentName:"p"},"(services o servicios)"),", damos click en la opcion de tuerca."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/buscando-los-servicios-de-windows.png",alt:"buscando los servicios de windows"})),(0,i.kt)("p",null,"Ahora, buscamos nuestro servicio."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/buscamos-nuestro-servicio.png",alt:"buscamos nuestro servicio"})),(0,i.kt)("p",null,"Damos click izquierdo sobre nuestro servicio y seleccionamos la opcion ",(0,i.kt)("strong",{parentName:"p"},"properties o propiedades"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/configuracion-por-defecto-en-las-propiedades-del-servicio.png",alt:"configuracion por defecto en las propiedades del servicio"})),(0,i.kt)("p",null,"Despues aparecera una ventana con unas propiedades por defecto."),(0,i.kt)("p",null,"Necesitamos cambiar la opcion de ",(0,i.kt)("strong",{parentName:"p"},"This Account")," a ",(0,i.kt)("strong",{parentName:"p"},"Local System Account"),", damos click en ",(0,i.kt)("strong",{parentName:"p"},"apply")," o ",(0,i.kt)("strong",{parentName:"p"},"aplicar")," y guardamos los cambios."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/cambiando-opcion-a-localSystemAccount.png",alt:"cambiando opcion a localSystemAccount"})),(0,i.kt)("p",null,"Despues de configurar las propiedades del servicio, damos click en ",(0,i.kt)("strong",{parentName:"p"},"start o iniciar"),". Esta opcion se encuentra en la parte superior de la ventana."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/iniciando-el-servicio.png",alt:"iniciando el servicio"})),(0,i.kt)("p",null,"Inmediatamente las opciones del servicio cambiaran a ",(0,i.kt)("strong",{parentName:"p"},"Stop")," y ",(0,i.kt)("strong",{parentName:"p"},"Restart")," o ",(0,i.kt)("strong",{parentName:"p"},"Parar")," y ",(0,i.kt)("strong",{parentName:"p"},"Reiniciar"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/se-habilitan-dos-opciones-para-el-servicio.png",alt:"se habilitan dos opciones para el servicio"})),(0,i.kt)("h2",{id:"resultado-final"},"Resultado Final"),(0,i.kt)("p",null,"Borro la carpeta y a los segundos vulve a aparecer sin crearla yo mismo, eso es gracias al servicio que estaba en funcionamiento y como puedes ver cada 5 segundos le agregaba texto extra al archivo de text llamado log."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"/exposition-net-framework/img/wService/mostrando-servicio-de-windows.gif",alt:"mostrando servicio de windows"})))}m.isMDXComponent=!0}}]);